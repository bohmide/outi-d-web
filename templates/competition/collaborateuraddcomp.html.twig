{% extends "base.html.twig" %}

{% block title %}Ajouter une Comp√©tition{% endblock %}

{% block body %}
<div class="collaborateur">

    <div class="publish-competition-container">
        <h1>Publier une Nouvelle Comp√©tition</h1>

        {{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }} {# D√©sactive la validation HTML5 #}

<div class="form-group">
    {{ form_label(form.nom_entreprise) }}
    {{ form_widget(form.nom_entreprise, {'attr': {'class': 'form-control'}}) }}
    <div class="invalid-feedback d-block">
        {{ form_errors(form.nom_entreprise) }}  {# Affiche le message d'erreur si le champ est invalide #}
    </div>
</div>

<div class="form-group">
    {{ form_label(form.nom_comp) }}
    {{ form_widget(form.nom_comp, {'attr': {'class': 'form-control'}}) }}
    <div class="invalid-feedback d-block">
        {{ form_errors(form.nom_comp) }}  {# Affiche le message d'erreur si le champ est invalide #}
    </div>
</div>

<div class="form-group">
    {{ form_label(form.date_debut) }}
    {{ form_widget(form.date_debut, {'attr': {'class': 'form-control'}}) }}
    <div class="invalid-feedback d-block">
        {{ form_errors(form.date_debut) }}  {# Affiche le message d'erreur si le champ est invalide #}
    </div>
</div>

<div class="form-group">
    {{ form_label(form.date_fin) }}
    {{ form_widget(form.date_fin, {'attr': {'class': 'form-control'}}) }}
    <div class="invalid-feedback d-block">
        {{ form_errors(form.date_fin) }}  {# Affiche le message d'erreur si le champ est invalide #}
    </div>
</div>

<div class="form-group">
    {{ form_label(form.description) }}
    {{ form_widget(form.description, {'attr': {'class': 'form-control'}}) }}
    <div class="invalid-feedback d-block">
        {{ form_errors(form.description) }}  {# Affiche le message d'erreur si le champ est invalide #}
    </div>
</div>
<div class="form-group">
    {{ form_label(form.fichierFile) }}
    {{ form_widget(form.fichierFile, {'attr': {'class': 'form-control'}}) }}
    <div class="invalid-feedback d-block">
        {{ form_errors(form.fichierFile) }}  {# Affiche le message d'erreur si le champ est invalide #}
    
    </div>
</div>  

<div class="form-group">
    {{ form_label(form.organisation) }}
    {{ form_widget(form.organisation, {'attr': {'class': 'form-control'}}) }}
    <div class="invalid-feedback d-block">
        {{ form_errors(form.organisation) }}  {# Affiche le message d'erreur si le champ est invalide #}
    
    </div>
</div>  
 {# üåç Ajout de la carte pour la localisation #}
<div class="form-group">
    <label>Localisation</label>
    <div id="map" style="height: 400px;"></div> {# Carte OpenStreetMap #}
    {{ form_widget(form.localisation, {'id': 'localisation', 'attr': {'type': 'hidden'}}) }}

</div>

<script>
   document.addEventListener("DOMContentLoaded", function () {
    var map = L.map('map').setView([36.8065, 10.1815], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    var marker;
    var localisationField = document.getElementById('localisation');

    map.on('click', function (e) {
        if (marker) {
            marker.setLatLng(e.latlng);
        } else {
            marker = L.marker(e.latlng).addTo(map);
        }
        localisationField.value = e.latlng.lat + "," + e.latlng.lng;
        console.log("Localisation s√©lectionn√©e :", localisationField.value); // V√©rification
    });
});

</script>

<button type="submit" class="submit-button">Publier la Comp√©tition</button>



{{ form_end(form) }}

    </div>
</div>



{% endblock %}
